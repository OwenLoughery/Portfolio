---
title: "GoPro Graphs"
format: 
  html:
    embed-resources: true
    code-tools: true
    toc: true
    number-sections: false
    code-fold: true
editor: source
execute: 
  error: true
  echo: true
  message: false
  warning: false

---

Reading in Libraries
```{r}
library(tidyverse)
library(ggrepel)
```

Reading in Data
```{r}
df <- read.csv("C:/Users/rdlou/Downloads/Marketing Event_Grassroots Analysis (Marketing Ops) - cleaninfluencer.csv")
clean <- read.csv("C:/Users/rdlou/Downloads/clean.csv")
grail <- read.csv("C:/Users/rdlou/Downloads/grail.csv")

#General cleaning of datasets
clean <- clean |>
  mutate(across(everything(), ~ gsub("[$,]", "", .)))
grail <- grail |>
  mutate(across(everything(), ~ gsub("[$,]", "", .)))
clean <- clean |>
  filter(Events != "") |>
  mutate(Combined_Impressions = as.numeric(Combined_Impressions),
         Total_Cost = as.numeric(Total_Cost),
         GoPro.Combined.Social.CPM = as.numeric(GoPro.Combined.Social.CPM),
         Estimate_Total_Profit = as.numeric(Estimate_Total_Profit),
         Est_Media_Rev = as.numeric(Est_Media_Rev),
         Event_Region = case_when(
           Events == "Weekender Snowdays FWT 2025" ~ "North America",
           TRUE ~ Event_Region
         ),
         Event_Region = as.factor(Event_Region),
         Event_Veritcal = as.factor(Event_Veritcal),
         ) 
grail <- grail |>
  mutate(GoPro_Combined_Social_CPM = as.numeric(GoPro_Combined_Social_CPM),
         Impressions = as.numeric(Impressions),
         CPM = as.numeric(CPM),
         Estimate_Total_Profit = as.numeric(Estimate_Total_Profit),
         Total_Cost = as.numeric(Total_Cost),
         Media_Value = as.factor(Media_Value)
         )


#Creating Event Regions variable to use for graphing purposes
clean <- clean |>
  mutate(Event_Region = case_when(
    grepl("Brazil|Panama|Fiji|Xcaret|Mexico|Rio|Balneário", Events, ignore.case = TRUE) ~ "LATAM/ROLA",
    grepl("Slovenia|Barcelona|Interlaken|Switzerland", Events, ignore.case = TRUE) ~ "EMEA",
    grepl("Arkansas|Utah|Pinehurst|Snowdays|California", Events, ignore.case = TRUE) ~ "North America",
    grepl("Songkran|Party Wave", Events, ignore.case = TRUE) ~ "SEA",
    TRUE ~ Event_Region
  ))
```


Graph comparing the total cost of an event and the estimated media value gained. Both axes are log-scaled to help visualize the wide range of event sizes and returns. The dashed 45° line (slope = 1) represents where an event’s media value equals its cost. So, events above the line delivered positive ROI, generating more media value than they cost while events below the line delivered negative ROI.
```{r, fig.width=10, fig.height=7}
ggplot(clean, aes(x = Total_Cost, y = Est_Media_Rev, color = Event_Region)) +
  geom_point(alpha = 0.6, size = 3) +
  geom_abline(slope = 1, intercept = 0, color = "red", linetype = "dashed") +
  scale_x_log10(labels = scales::comma) +
  scale_y_log10(labels = scales::comma) +
  geom_text_repel(aes(label = Events), size = 3, max.overlaps = 10) +
  theme_minimal() + 
  theme(
    legend.position = "right",
    legend.box = "horizontal"
  ) +
  guides(color = guide_legend(ncol = 1)) +
  scale_color_manual(values = c(
    "EMEA" = "steelblue",
    "LATAM/ROLA"        = "darkorange",
    "North America"          = "forestgreen",
    "SEA" = "purple"
  )) +
  labs(
    title = "Total Cost vs. Media Value (Rev)",
    subtitle = "Estimated Media Value (Rev)",
    y = "",
    x = "Total Cost"
  )
```


Graph visualizing event performance by comparing efficiency (CPM - cost per 1,000 impressions) versus Impact (total impressions generated). The plot is log-scaled on the y-axis to account for the extreme variation in audience reach across events. 
The vertical red line at CPM = 10 separates efficient (right side) from inefficient (left side) events.
The horizontal blue line at 1,250,000 impressions separates high-impact (above) from low-impact (below) events.
The resulting quadrants reflect how we decided to classify the ROI profiles of the events.
```{r, fig.width=10, fig.height=7}
ggplot(grail, aes(x = GoPro_Combined_Social_CPM, y = Impressions)) +
  annotate("rect", xmin = 20, xmax = 10, ymin = 0, ymax = 1255000,
           fill = "red", alpha = 0.1) +
  annotate("rect", xmin = 10, xmax = 0, ymin = 1255000, ymax = Inf,
           fill = "green", alpha = 0.1) +
  
  geom_point() +
  geom_text_repel(aes(label = Events), size = 3, max.overlaps = 10) +
  
  geom_point(data = subset(grail, GoPro_Combined_Social_CPM > 20),
             aes(x = 20, y = Impressions), shape = 17, size = 3, color = "black") +
  geom_text_repel(data = subset(grail, GoPro_Combined_Social_CPM > 20),
             aes(x = 20, y = Impressions, label = Events), size = 3) +

  scale_x_reverse(limits = c(20, 0)) +
  scale_y_log10(labels = scales::comma) +
  
  labs(
  x = "CPM (Cost per 1000 Impressions)",
  y = "",
  subtitle = "Impressions (Log-scaled)",
  title = "Efficiency vs Impact (aka <span style='color:gold;'>The Holy Grail</span>)"
  ) +
  
  geom_vline(xintercept = 10, linetype = "dashed", color = "red") +
  geom_hline(yintercept = 1255000, linetype = "dashed", color = "blue") +
  
  theme_minimal() +
  theme(
    plot.title = ggtext::element_markdown(size = 16, face = "bold")
  )
  
```





